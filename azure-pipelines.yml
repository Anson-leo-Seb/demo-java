trigger:
- master

pool:
  vmImage: ubuntu-latest

variables:
  azureSubscription: 'ME-MngEnvMCAP482325-v-ansonse-1 (ffb8fed6-6921-49f0-8eb8-2e00a9000d9a)'
  appName: 'Java-webapp'
  packagePath: '$(System.DefaultWorkingDirectory)/**/*.war'

steps:
# Checkout source
- checkout: self

# Build .war using Maven
- task: Maven@3
  inputs:
    mavenPomFile: 'pom.xml'
    goals: 'package'
    javaHomeOption: 'JDKVersion'
    jdkVersionOption: '1.11'
    publishJUnitResults: true
    testResultsFiles: '**/surefire-reports/TEST-*.xml'

# Publish WAR to Azure Web App
- task: AzureWebApp@1
  inputs:
    azureSubscription: $(azureSubscription)
    appName: $(appName)
    package: $(packagePath)
    appType: webAppLinux   # or 'webApp' for Windows

